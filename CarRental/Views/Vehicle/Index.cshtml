@model IEnumerable<Vehicle>
@{
    ViewBag.Title = "Car Rental";
    var successMessage = TempData["SuccessMessage"] as string;
    var searchString = Context.Request.Query["searchString"]; // Get the search string from the query
}
@if (!string.IsNullOrEmpty(successMessage))
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        @successMessage
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}
<div class="row">
    <div class="col-md-4 offset-md-4">
        <div class="input-group mb-3">
            <input type="text" id="searchString" name="searchString" class="form-control" placeholder="Search by brand..." value="@searchString" />
        </div>
    </div>
</div>

<div id="partialDisplay">
    @* @await Html.PartialAsync("_DisplayVehicles", Model) *@
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            // Function to perform AJAX search
            function searchVehicles() {
                var searchString = $("#searchString").val();

                $.ajax({
                    url: "/Vehicle/AllVehiclePartial",
                    type: "GET",
                    data: { searchString: searchString },
                    success: function (data) {
                        $("#partialDisplay").html(data); // Update the partial view
                    },
                    error: function () {
                        alert("An error occurred during the search.");
                    }
                });
            }

        // Initial Load
        refreshPartialView();

        // Handle Search Form Submission (using AJAX)
        $('form').submit(function (event) {
            event.preventDefault(); // Prevent default form submission
            var searchString = $('input[name=searchString]').val();
            refreshPartialView(searchString);
        });
    </script>
}